"""Tests for the dynamodb nuke class."""

import boto3
import time

from moto import mock_dynamodb2

from package.database.dynamodb import NukeDynamodb

from .utils import create_dynamodb


@mock_dynamodb2
def test_dynamodb_nuke():
    """Verify dynamodb nuke function."""
    aws_region = "eu-west-1"
    client = boto3.client("ec2", region_name=aws_region)

    create_dynamodb(region_name=aws_region)
    dynamodb = NukeDynamodb(aws_region)
    dynamodb.nuke(older_than_seconds=time.time())
    dynamodb_list = client.list_tables()["TableNames"]
    assert len(dynamodb_list) == 0
